SELECT calls,userid::regrole, dbid,total_exec_time,total_exec_time/calls avg_exec_time_one_time,(shared_blks_hit+shared_blks_dirtied)/calls avg_blks, substr(query,1,1000) FROM sys_stat_statements where query !='COMMIT TRANSACTION' and calls >10 and userid not in(select oid from pg_roles where rolname='esrep' or rolname='system') ORDER BY (shared_blks_hit+shared_blks_dirtied)/calls DESC LIMIT 10;
